<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>voice</title>
<style>
    body {
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #circle {
        width: 50vh;
        height: 50vh;

        background-color: #818181;
        border-radius: 50%;
        display: flex;
    }
    #text {
        font-size: 32px;
        margin: auto;
        font-family: Helvetica, Arial, sans-serif;
    }
</style>
</head>

<body>
    <div id="circle"><div id="text"></div></div>
<script>
  navigator.getUserMedia({
      audio: true
    },
    function (stream) {
        var a = window.AudioContext || window.webkitAudioContext;
        audioContext = new a();
        analyser = audioContext.createAnalyser();
        microphone = audioContext.createMediaStreamSource(stream);
        proc = audioContext.createScriptProcessor(2048, 1, 1);

        analyser.smoothingTimeConstant = 0.9;
        analyser.fftSize = 1024;
        microphone.connect(analyser);
        analyser.connect(proc);
        proc.connect(audioContext.destination);

        proc.onaudioprocess = function() {
            var array = new Uint8Array(analyser.frequencyBinCount);
            analyser.getByteFrequencyData(array);
            var values = 0;

            var length = array.length;
            for (var i = 0; i < length; i++) {
                values += (array[i]);
            }

            var average = values / length;
            var val = Math.round(average - 40);
            if (val > 20) {
                document.getElementById('circle').style.backgroundColor = '#DA0000';
            } else if (val > -10) {                
                document.getElementById('circle').style.backgroundColor = '#ECDC28';
            } else {                
                document.getElementById('circle').style.backgroundColor = '#1FAB08';
            }
            document.getElementById('text').innerHTML = val;
        }

    },
    function () {
        alert('Unable to connect to mic');
    }
)
</script>

</body>

</html>